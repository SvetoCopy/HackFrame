<h1>HackFrame by Ruzal</h1>

<h2>Что взламываем?</h2>
<p>У нас есть программа VZLOM.COM, имеющая пару небольших уязвимостей. Моей задачей было сделать 2 взлома:</p>
<li>Используя только ввод символов.</li>
<li>Используя замену байтов в COM-файле.</li>

<h2>Взлом через переполнение буфера</h2>
<p>Для поиска неуязвимостей мы использовали дизассемблер IDA. Давайте попробуем изучить полученный ассемблерный код.</p>
<h3>Начало программы:</h3>

![image](https://github.com/SvetoCopy/HackFrame/assets/65361271/948f55ea-703e-406e-89ee-69cd541460c1)

<p>Тут мы видим, что в регистр es кладут 0b800h, что соответствует адресу видеопамяти. Затем вызываются процедуры, которым я уже дал названия.
Давайте посмотрим их.</p>

<h3>write_frame:</h3>

![image](https://github.com/SvetoCopy/HackFrame/assets/65361271/e77512ea-5ac0-4cd1-84eb-ef56d30193f2)

<p>Эта процедура отвечает только за отрисовку рамки на экране:</p>

![image](https://github.com/SvetoCopy/HackFrame/assets/65361271/2c259c85-4fd8-41b4-942d-f1b40aa34c0b)

<h3>get_input:</h3>

![image](https://github.com/SvetoCopy/HackFrame/assets/65361271/e6c075e9-7af5-4fad-a4fa-0916915b51b0)

<p>Видим, что вызывается 8 функция 21 прерывания - DOS NoEchoInput и байты записываются по адресу 111h + CX. Запомним этот адрес.</p>

<h3>hash_str:</h3>

![image](https://github.com/SvetoCopy/HackFrame/assets/65361271/f6261658-fbb6-429e-8e90-17f02f1a219b)

<p>Не будем рассматривать подробности хэширования пароля, важно знать лишь, что зашифрованный пароль будет находиться по регистру DX</p>

<h3>check_pwd:</h3>

![image](https://github.com/SvetoCopy/HackFrame/assets/65361271/e795a85e-85c6-422a-a3d0-b8cc7f82df8c)

<p>Наконец, самая важная процедура, которая проверяет пароль. Заметим, что лишь одна проверка решает, дать доступ или нет:<p>

```asm
cmp dx, 26Ch
jnz short ...
```

<p>Программу было бы легко взломать, если это условие как-то затереть или заменить. Рассмотрим, что находится рядом с этой процедурой:</p>

![image](https://github.com/SvetoCopy/HackFrame/assets/65361271/16c80693-d977-41aa-ba41-bc8f1fd62b73)

<p>Видим какие-то странные команды. Посмотрим на адрес:</p>

![image](https://github.com/SvetoCopy/HackFrame/assets/65361271/e9f787a5-b325-48c9-8b0f-b074c6ebc79e)

<p>И наконец, мы нашли уязвимость, потому что это просто буфер ввода из get_input. Получается, если переполнить буфер, можно заменить байты, отвечающие за проверку хэша.</p>
<p>Подбираем пароль, например:</p>

```
ZZZZZZZZZZZZZZZZZZ
```
<p>Подобрав необходимый пароль, получаем:</p>

![image](https://github.com/SvetoCopy/HackFrame/assets/65361271/b836415b-0849-4e12-853e-81e8f87a26ab)

<h2>Взлом через замену байтов</h2>

<p>Принцип взлома остается таким же, мы также затираем ту единственную проверку, но теперь сделаем это с помощью программы, написанной на C.</p>
<p>Программа заполняет каким-то количеством NOP в некотором месте COM-файла. У программы есть интуитивное GUI:</p>

![image](https://github.com/SvetoCopy/HackFrame/assets/65361271/b3a44f5c-738c-426f-b74f-5890660c5b90)

<p>Нажимаем на кнопку ВЗЛОМ:</p>

![image](https://github.com/SvetoCopy/HackFrame/assets/65361271/20b6a0a7-d921-4690-b26a-e7da53af2cf3)

<p>Это означает, что программа взломана. Теперь рассмотрим дизассемблированный код до и после:</p>

<p>До:</p>

![image](https://github.com/SvetoCopy/HackFrame/assets/65361271/8e9d0099-c070-4c0b-af47-5f4938611e7a)

<p>После:</p>

![image](https://github.com/SvetoCopy/HackFrame/assets/65361271/45bf47d8-9148-4d47-a6c3-aa4f82b4b377)

<p>Теперь запускаем нашу программу и вводим любой пароль и получаем:</p>

![image](https://github.com/SvetoCopy/HackFrame/assets/65361271/c389fff0-b4cd-4b9b-99f3-8e7d9629e680)
